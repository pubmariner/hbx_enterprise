hios_2014_to_2015 = {
        "77422DC0060001" => "77422DC0060002",
        "77422DC0060003" => "77422DC0060002",
        "77422DC0060007" => "77422DC0060008",
        "77422DC0060009" => "77422DC0060008",
        "78079DC0210001" => "78079DC0210001",
        "73987DC0040002" => "73987DC0040001",
        "73987DC0040003" => "73987DC0040005",
        "73987DC0040004" => "73987DC0040005",
        "73987DC0040009" => "73987DC0040033",
        "73987DC0040010" => "73987DC0040033",
        "73987DC0040011" => "73987DC0040013",
        "73987DC0040012" => "73987DC0040013",
        "73987DC0040018" => "73987DC0040017",
        "73987DC0040022" => "73987DC0040021",
        "73987DC0040026" => "73987DC0040025",
        "73987DC0040030" => "73987DC0040029",
        "77422DC0070002" => "77422DC0070001",
        "77422DC0070006" => "77422DC0070005",
        "77422DC0070010" => "77422DC0070009",
        "77422DC0070018" => "77422DC0070017",
        "77422DC0060003" => "77422DC0060002",
        "77422DC0060009" => "77422DC0060008",
        "77422DC0070022" => "77422DC0070021",
        "41842DC0040021" => "41842DC0040020",
        "41842DC0040023" => "41842DC0040022",
        "41842DC0040074" => "41842DC0010052",
        "41842DC0040073" => "41842DC0010052",
        "41842DC0040078" => "41842DC0010048",
        "41842DC0040077" => "41842DC0010048",
        "41842DC0040092" => "41842DC0040091",
        "41842DC0040094" => "41842DC0040093",
        "41842DC0040072" => "41842DC0040071",
        "41842DC0040076" => "41842DC0040075",
        "41842DC0040090" => "41842DC0010052",
        "41842DC0040089" => "41842DC0010052",
        "41842DC0040088" => "41842DC0010050",
        "41842DC0040079" => "41842DC0010050",
        "41842DC0040016" => "41842DC0040015",
        "41842DC0040025" => "41842DC0040024",
        "41842DC0040027" => "41842DC0040026",
        "41842DC0040029" => "41842DC0040028",
        "41842DC0040096" => "41842DC0040095",
        "41842DC0040100" => "41842DC0040099",
        "41842DC0040102" => "41842DC0040101",
        "41842DC0040104" => "41842DC0040103",
        "41842DC0040098" => "41842DC0040097",
        "41842DC0010005" => "41842DC0010004",
        "41842DC0010007" => "41842DC0010006",
        "41842DC0010045" => "41842DC0010052",
        "41842DC0010044" => "41842DC0010052",
        "41842DC0010049" => "41842DC0010048",
        "41842DC0010055" => "41842DC0010054",
        "41842DC0010033" => "41842DC0010032",
        "41842DC0010047" => "41842DC0010046",
        "41842DC0010057" => "41842DC0010056",
        "41842DC0010053" => "41842DC0010028",
        "41842DC0010051" => "41842DC0010050",
        "41842DC0010003" => "41842DC0010002",
        "41842DC0010009" => "41842DC0010008",
        "41842DC0010011" => "41842DC0010010",
        "41842DC0010013" => "41842DC0010012",
        "41842DC0010061" => "41842DC0010060",
        "41842DC0010063" => "41842DC0010062",
        "41842DC0010065" => "41842DC0010064",
        "41842DC0010059" => "41842DC0010058",
        "75753DC0020037" => "75753DC0010009",
        "75753DC0020036" => "75753DC0010009",
        "75753DC0010010" => "75753DC0010009",
        "75753DC0020035" => "75753DC0010007",
        "75753DC0020034" => "75753DC0010007",
        "75753DC0010008" => "75753DC0010007",
        "75753DC0010006" => "75753DC0010072",
        "75753DC0010005" => "75753DC0010071",
        "75753DC0010004" => "75753DC0010070",
        "75753DC0020032" => "75753DC0010002",
        "75753DC0020033" => "75753DC0010002",
        "75753DC0010003" => "75753DC0010002",
        "75753DC0020042" => "75753DC0010015",
        "75753DC0020043" => "75753DC0010015",
        "75753DC0010016" => "75753DC0010015",
        "75753DC0020040" => "75753DC0010011",
        "75753DC0020041" => "75753DC0010011",
        "75753DC0020038" => "75753DC0010013",
        "75753DC0020039" => "75753DC0010013",
        "75753DC0010014" => "75753DC0010013",
        "75753DC0010012" => "75753DC0010011",
        "75753DC0020031" => "75753DC0010001",
        "75753DC0020027" => "75753DC0010058",
        "75753DC0020026" => "75753DC0010057",
        "75753DC0020018" => "75753DC0010048",
        "75753DC0020019" => "75753DC0010048",
        "75753DC0010049" => "75753DC0010048",
        "75753DC0010047" => "75753DC0010046",
        "75753DC0020017" => "75753DC0010044",
        "75753DC0020016" => "75753DC0010044",
        "75753DC0010045" => "75753DC0010044",
        "75753DC0020015" => "75753DC0010042",
        "75753DC0020014" => "75753DC0010042",
        "75753DC0010043" => "75753DC0010042",
        "75753DC0020013" => "41842DC0010052",
        "75753DC0020012" => "41842DC0010052",
        "75753DC0010041" => "41842DC0010052",
        "75753DC0010040" => "41842DC0010052",
        "75753DC0020011" => "41842DC0010050",
        "75753DC0020030" => "41842DC0010050",
        "75753DC0010039" => "41842DC0010050",
        "75753DC0010038" => "41842DC0010050",
        "75753DC0020010" => "41842DC0010048",
        "75753DC0020009" => "41842DC0010048",
        "75753DC0010037" => "41842DC0010048",
        "75753DC0010036" => "41842DC0010048",
        "75753DC0020008" => "75753DC0010034",
        "75753DC0020007" => "75753DC0010034",
        "75753DC0010035" => "75753DC0010034",
        "75753DC0020005" => "41842DC0010052",
        "75753DC0020006" => "41842DC0010052",
        "75753DC0020025" => "75753DC0010056",
        "75753DC0020023" => "75753DC0010054",
        "75753DC0020024" => "75753DC0010054",
        "75753DC0010055" => "75753DC0010054",
        "75753DC0020022" => "41842DC0010062",
        "75753DC0010052" => "41842DC0040101",
        "75753DC0010053" => "41842DC0040101",
        "75753DC0020020" => "41842DC0010060",
        "75753DC0020021" => "41842DC0010060",
        "75753DC0010050" => "41842DC0040099",
        "75753DC0010051" => "41842DC0040099",
        "75753DC0010033" => "41842DC0010052",
        "75753DC0010032" => "41842DC0010052",
        "75753DC0020003" => "75753DC0010030",
        "75753DC0020004" => "75753DC0010030",
        "75753DC0010031" => "75753DC0010030",
        "75753DC0020002" => "75753DC0010029",
        "75753DC0020001" => "75753DC0010028"
      }

plans_2014 = Plan.where({year: 2014})
plans_2015 = Plan.where({year: 2015})

map_for_2015 = plans_2015.inject({}) do |h, plan|
  h[plan.hios_plan_id] = plan
  h
end

def get_map_hios(current_year_hios, hios_map)
  components = current_year_hios.split("-")
  main_component = components.first
  variant = ""
  if components.length > 1
    variant = "-#{components.last}"
  end
  if hios_map.has_key?(main_component)
    return(hios_map[main_component] + variant)
  end
  current_year_hios
end

failed_maps = []

plans_2014.each do |pl|
  renewal_plan = map_for_2015[get_map_hios(pl.hios_plan_id, hios_2014_to_2015)]
  if renewal_plan.blank?
    failed_maps << pl.hios_plan_id
  end
#  pl.save!
end

puts failed_maps.inspect
